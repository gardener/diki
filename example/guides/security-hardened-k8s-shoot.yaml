providers:
- id: managedk8s
  name: "Managed Kubernetes"
  metadata: # custom user metadata
    # shootName: <shoot-name>
    # foo: bar
  args:
    kubeconfigPath: <shoot-kubeconfig-path>  # path to shoot admin kubeconfig
  rulesets:
  - id: security-hardened-k8s
    name: Security Hardened Kubernetes Cluster
    version: v0.1.0
    ruleOptions:
    - ruleID: "2000"
      args:
        acceptedNamespaces:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "Gardener managed namespaces are accepted to allow traffic by default."
          acceptedTraffic:
            ingress: true
            egress: true
    - ruleID: "2001"
      args:
        acceptedPods:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          namespaceLabelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "Gardener managed resources are accepted to allow privilege escalation."
    - ruleID: "2003"
      args:
        acceptedPods:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          namespaceLabelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "Gardener managed resources are accepted to use a wider range of volume types."
          volumeNames:
          - "*"
    - ruleID: "2004"
      args:
        acceptedServices:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          namespaceLabelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "Gardener managed services are accepted to be of type NodePort."
    - ruleID: "2006"
      args:
        acceptedRoles:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          namespaceLabelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "Roles managed by Gardener are accepted to use wildcards in RBAC resources."
        acceptedClusterRoles:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "ClusterRoles managed by Gardener are accepted to use wildcards in RBAC resources."
        - labelSelector:
            matchLabels:
              kubernetes.io/bootstrapping: rbac-defaults
          justification: "Kubernetes default ClusterRoles are accepted to use wildcards in RBAC resources."
    - ruleID: "2007"
      args:
        acceptedRoles:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          namespaceLabelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "Roles managed by Gardener are accepted to use wildcards in RBAC verbs."
        acceptedClusterRoles:
        - labelSelector:
            matchLabels:
            resources.gardener.cloud/managed-by: gardener
          justification: "ClusterRoles managed by Gardener are accepted to use wildcards in RBAC verbs."
        - labelSelector:
            matchLabels:
              kubernetes.io/bootstrapping: rbac-defaults
          justification: "Kubernetes default ClusterRoles are accepted to use wildcards in RBAC verbs."
    - ruleID: "2008"
      args:
        acceptedPods:
        - labelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          namespaceLabelSelector:
            matchLabels:
              resources.gardener.cloud/managed-by: gardener
          justification: "Gardener managed resources are accepted to use a wider range of volume types."
          volumeNames:
          - "*"
output:
  minStatus: Passed
